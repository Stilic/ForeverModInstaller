os: windows
language: shell
env:
  global:
  - PY37PATH=/c/Python39:/c/Python39/Scripts
matrix:
  include:
  - name: Build
    env: PATH=$PY37PATH:$PATH
    before_install:
    - choco install python
install:
- py -m pip install --upgrade pip
- py -m pip install -r requirements.txt
script:
- pyinstaller --noconfirm --onefile --name "fmi" main.py
- pyinstaller --noconfirm --onefile registerProtocol.py
- pyinstaller --noconfirm --onefile removeProtocol.py
before_deploy:
  - git config --local user.name "YOUR GIT USER NAME"
  - git config --local user.email "YOUR GIT USER EMAIL"
  - export TRAVIS_TAG=${TRAVIS_TAG:-$(date +'%Y%m%d%H%M%S')-$(git log --format=%h -1)}
  - git tag $TRAVIS_TAG
deploy:
  provider: releases
  api_key: "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"
  file_glob: true
  file: dist/*
  skip_cleanup: true
  draft: true
